<?xml version="1.0"?>
<!-- 
XArm 6-DOF Robotic Arm URDF (Converted Format)
Author: Aayush Rath | Date: 10/08/2025

Defines the URDF model for a 6-DOF XArm robotic arm using STL/OBJ meshes.  
Implements Xacro macros for reusable link and joint definitions,  
with conditional mesh path resolution for Gazebo or RViz usage.

Includes:
- `mesh_link` macro for defining links with visual, collision, and inertial properties
- `revolute_joint` macro for defining revolute joints with limits
- Conditional `mesh_path` property based on `use_gazebo` argument
- Base link and 6 arm links with proper kinematic chain

Usage:
- Set `use_gazebo` argument to `true` for simulation with Gazebo, or `false` for RViz-only usage
- Place STL/OBJ meshes in the `meshes/robotic_arm/` directory
- Launch with:  
  `ros2 launch urdf_tutorial display.launch.py model:=<path_to_this_file> use_gazebo:=true`
-->
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="robotic_arm">
    <xacro:arg name="use_gazebo" default="false"/>
    <!-- ================= CHECK USAGE ================= -->
    <!-- Conditional mesh path -->
    <xacro:if value="$(arg use_gazebo)">
        <xacro:property name="mesh_path" value="$(find nolon_bot_description)/meshes/robotic_arm/"/>
    </xacro:if>
    <xacro:unless value="$(arg use_gazebo)">
        <xacro:property name="mesh_path" value="file:///home/aayush/Internship/nolon_bot_ws/src/nolon_bot_description/meshes/robotic_arm/"/>
    </xacro:unless>

    <!-- ================= MATERIALS ================= -->
    <material name="White">
        <color rgba="1.0 1.0 1.0 1.0"/>
    </material>

    <material name="Silver">
        <color rgba="0.75 0.75 0.75 1.0"/>
    </material>

    <!-- ================= MACROS ================= -->

    <!-- Generic mesh link with separate visual and collision meshes -->
    <xacro:macro name="mesh_link" params="name visual_mesh collision_mesh mass ixx iyy izz ixy ixz iyz ox oy oz orx ory orz material_name:=White">
        <link name="${name}">
            <visual>
                <origin xyz="${ox} ${oy} ${oz}" rpy="${orx} ${ory} ${orz}"/>
                <geometry>
                    <mesh filename="${mesh_path}${visual_mesh}.stl"/>
                </geometry>
                <material name="${material_name}"/>
            </visual>
            <collision>
                <origin xyz="${ox} ${oy} ${oz}" rpy="${orx} ${ory} ${orz}"/>
                <geometry>
                    <mesh filename="${mesh_path}${collision_mesh}.stl"/>
                </geometry>
            </collision>
            <inertial>
                <mass value="${mass}"/>
                <origin xyz="${ox} ${oy} ${oz}" rpy="${orx} ${ory} ${orz}"/>
                <inertia ixx="${ixx}" iyy="${iyy}" izz="${izz}" ixy="${ixy}" ixz="${ixz}" iyz="${iyz}"/>
            </inertial>
        </link>
    </xacro:macro>

    <!-- Revolute joint -->
    <xacro:macro name="revolute_joint" params="name parent child ax ay az ox oy oz orx ory orz lower upper effort vel">
        <joint name="${name}" type="revolute">
            <parent link="${parent}"/>
            <child link="${child}"/>
            <axis xyz="${ax} ${ay} ${az}"/>
            <origin xyz="${ox} ${oy} ${oz}" rpy="${orx} ${ory} ${orz}"/>
            <limit lower="${lower}" upper="${upper}" effort="${effort}" velocity="${vel}"/>
            <dynamics damping="1.0" friction="1.0"/>
        </joint>
    </xacro:macro>

    <!-- ================= ROBOT STRUCTURE ================= -->

    <!-- BASE LINK -->
    <link name="link_base">
        <visual>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="${mesh_path}link_base.stl"/>
            </geometry>
            <material name="White"/>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="${mesh_path}link_base.stl"/>
            </geometry>
        </collision>
        <inertial>
            <origin xyz="0.0 0.0 0.09103" rpy="0 0 0"/>
            <mass value="0.01"/>
            <inertia ixx="0.00494875" ixy="-3.5E-06" ixz="1.25E-05"
                     iyy="0.00494174" iyz="1.67E-06" izz="0.002219"/>
        </inertial>
    </link>

    <!-- ARM LINKS -->
    <xacro:mesh_link name="link1" visual_mesh="link1" collision_mesh="link1" 
                     mass="0.01" ixx="0.001" iyy="0.001" izz="0.001" ixy="0" ixz="0" iyz="0" 
                     ox="0" oy="0" oz="0" orx="0" ory="0" orz="0" material_name="White"/>

    <xacro:mesh_link name="link2" visual_mesh="link2" collision_mesh="link2" 
                     mass="0.01" ixx="0.001" iyy="0.001" izz="0.001" ixy="0" ixz="0" iyz="0" 
                     ox="0" oy="0" oz="0" orx="0" ory="0" orz="0" material_name="White"/>

    <xacro:mesh_link name="link3" visual_mesh="link3" collision_mesh="link3" 
                     mass="0.01" ixx="0.001" iyy="0.001" izz="0.001" ixy="0" ixz="0" iyz="0" 
                     ox="0" oy="0" oz="0" orx="0" ory="0" orz="0" material_name="White"/>

    <xacro:mesh_link name="link4" visual_mesh="link4" collision_mesh="link4" 
                     mass="0.01" ixx="0.001" iyy="0.001" izz="0.001" ixy="0" ixz="0" iyz="0" 
                     ox="0" oy="0" oz="0" orx="0" ory="0" orz="0" material_name="White"/>

    <xacro:mesh_link name="link5" visual_mesh="link5" collision_mesh="link5" 
                     mass="0.01" ixx="0.001" iyy="0.001" izz="0.001" ixy="0" ixz="0" iyz="0" 
                     ox="0" oy="0" oz="0" orx="0" ory="0" orz="0" material_name="White"/>

    <xacro:mesh_link name="link6" visual_mesh="link6" collision_mesh="link6" 
                     mass="0.01" ixx="0.001" iyy="0.001" izz="0.001" ixy="0" ixz="0" iyz="0" 
                     ox="0" oy="0" oz="0" orx="0" ory="0" orz="0" material_name="Silver"/>

    <!-- ARM JOINTS -->
    <xacro:revolute_joint name="joint1" parent="link_base" child="link1" 
                          ax="0" ay="0" az="1" ox="0" oy="0" oz="0.267" orx="0" ory="0" orz="0" 
                          lower="-${2*pi}" upper="${2*pi}" effort="50.0" vel="3.14"/>

    <xacro:revolute_joint name="joint2" parent="link1" child="link2" 
                          ax="0" ay="0" az="1" ox="0" oy="0" oz="0" orx="-1.5708" ory="0" orz="0" 
                          lower="-2.059" upper="2.0944" effort="50.0" vel="3.14"/>

    <xacro:revolute_joint name="joint3" parent="link2" child="link3" 
                          ax="0" ay="0" az="1" ox="0.0535" oy="-0.2845" oz="0" orx="0" ory="0" orz="0" 
                          lower="-3.927" upper="0.19198" effort="32.0" vel="3.14"/>

    <xacro:revolute_joint name="joint4" parent="link3" child="link4" 
                          ax="0" ay="0" az="1" ox="0.0775" oy="0.3425" oz="0" orx="-1.5708" ory="0" orz="0" 
                          lower="-${2*pi}" upper="${2*pi}" effort="32.0" vel="3.14"/>

    <xacro:revolute_joint name="joint5" parent="link4" child="link5" 
                          ax="0" ay="0" az="1" ox="0" oy="0" oz="0" orx="0" ory="0" orz="0" 
                          lower="-1.69297" upper="${pi}" effort="32.0" vel="3.14"/>

    <xacro:revolute_joint name="joint6" parent="link5" child="link6" 
                          ax="0" ay="0" az="1" ox="0.076" oy="0.097" oz="0" orx="-1.5708" ory="0" orz="0" 
                          lower="-${2*pi}" upper="${2*pi}" effort="20.0" vel="3.14"/>

</robot>